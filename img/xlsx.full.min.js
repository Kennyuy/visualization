const fileInput = document.getElementById("fileInput");
const dropArea = document.getElementById("dropArea");

fileInput.addEventListener("change", (event) => {
    handleFileUpload(event.target.files[0]);
});

dropArea.addEventListener("drop", (e) => {
    e.preventDefault();
    dropArea.style.border = "2px dashed #ccc";
    const droppedFiles = e.dataTransfer.files;
    handleFileUpload(droppedFiles[0]);
});

// 文件上传函数
function handleFileUpload(file) {
    const reader = new FileReader();
    reader.readAsArrayBuffer(file);
    // 定义一个加载完成的回调，在 FileReader 完成文件读取操作后被调用。
    reader.onload = (event) => {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, { type: "array" });

        // 获取工作表名数组
        const sheetNameArray = workbook.SheetNames;
        // 获取第一个工作表
        const firstSheet = workbook.Sheets[sheetNameArray[0]];
        // 将工作表转换为二维数组
        const sheetDataArray = XLSX.utils.sheet_to_json(firstSheet, {
            // defval: "" // 配置这个得到对象数组的格式
            header: 1 // 得到二维数组
        });
        // 调用渲染 Excel 的函数
        renderTable(sheetDataArray);
    };
}

